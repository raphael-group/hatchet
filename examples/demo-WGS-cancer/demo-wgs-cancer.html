

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demo for WGS data from a cancer patient &mdash; HATCHet 2.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=0218eca2"></script>
      <script src="../../_static/doctools.js?v=888ff710"></script>
      <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            HATCHet
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">HATCHet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HATCHet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Demo for WGS data from a cancer patient</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/demo-WGS-cancer/demo-wgs-cancer.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="demo-for-wgs-data-from-a-cancer-patient">
<h1>Demo for WGS data from a cancer patient<a class="headerlink" href="#demo-for-wgs-data-from-a-cancer-patient" title="Permalink to this heading">¶</a></h1>
<p>: ex: set ft=markdown ;:&lt;&lt;’```shell’ #</p>
<p><strong>NOTE</strong>: this demo has not yet been updated for version 1.0 of HATCHet which includes variable-width binning, phasing, and locality-aware clustering.</p>
<p>The following HATCHet’s demo represents a guided example starting from WGS (whole-genome sequencing) data from 3 samples (A12-A, A12-C, and A12-D) of metastatic patient A12, previously published in (Gundem et al., Nature, 2015)). For simplicity, the demo starts from a BB file <code class="docutils literal notranslate"><span class="pre">demo-wgs-cancer.bb</span></code> (included in this demo at <code class="docutils literal notranslate"><span class="pre">examples/demo-WGS-cancer/</span></code>) which contains the RDR and BAF of every genomic bin and, therefore, we assume that the preliminary steps (i.e. <code class="docutils literal notranslate"><span class="pre">count-reads</span></code>, <code class="docutils literal notranslate"><span class="pre">count-alleles</span></code>, and <code class="docutils literal notranslate"><span class="pre">combine-counts</span></code>) have already been executed by running standard configuration for WGS data (bin size of 50kb through -b 50kb of count-reads, and the allele counts for germline heterozygous SNPs have been selected between 3 and 200 through <code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">3</span> <span class="pre">-C</span> <span class="pre">200</span></code>).</p>
<section id="requirements-and-set-up">
<h2>Requirements and set up<a class="headerlink" href="#requirements-and-set-up" title="Permalink to this heading">¶</a></h2>
<p>The demo requires that HATCHet has been successfully compiled and all the dependencies are available and functional. As such, the demo requires the user to properly set up the following paths:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">PY</span><span class="o">=</span><span class="s2">&quot;python3&quot;</span><span class="w"> </span><span class="c1"># This id the full path to the version of PYTHON3 which contains the required `hatchet` module. When this corresponds to the standard version, the user can keep the given value of `python3`</span>
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>The following paths are consequently obtained to point to the required components of HATCHet</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">CLUSTERBINS</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PY</span><span class="si">}</span><span class="s2"> -m hatchet cluster-bins&quot;</span>
<span class="nv">PLOTBINS</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PY</span><span class="si">}</span><span class="s2"> -m hatchet plot-bins&quot;</span>
<span class="nv">INFER</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PY</span><span class="si">}</span><span class="s2"> -m hatchet compute-cn&quot;</span>
<span class="nv">PLOTCN</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PY</span><span class="si">}</span><span class="s2"> -m hatchet plot-cn&quot;</span>
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We also ask the demo to terminate in case of errors and to print a trace of the execution by the following commands</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>-e
<span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>xtrace
<span class="nv">PS4</span><span class="o">=</span><span class="s1">&#39;[\t]&#39;</span>
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
</section>
<section id="global-clustering">
<h2>Global clustering<a class="headerlink" href="#global-clustering" title="Permalink to this heading">¶</a></h2>
<p>The first main step of the demo performs the global clustering of HATCHet where genomic bins which have the same copy-number state in every tumor clone are clustered correspondingly. To do this, we use <code class="docutils literal notranslate"><span class="pre">cluster-bins</span></code>, i.e. the HATCHet’s component designed for this purpose. At first, we attempt to run the clustering using the default values of the parameters as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">CLUSTERBINS</span><span class="si">}</span><span class="w"> </span>demo-wgs-cancer.bb<span class="w"> </span>-o<span class="w"> </span>demo-wgs-cancer.seg<span class="w"> </span>-O<span class="w"> </span>demo-wgs-cancer.bbc<span class="w"> </span>-e<span class="w"> </span><span class="m">12</span><span class="w"> </span>-tB<span class="w"> </span><span class="m">0</span>.03<span class="w"> </span>-tR<span class="w"> </span><span class="m">0</span>.15<span class="w"> </span>-d<span class="w"> </span><span class="m">0</span>.08
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>For different type of data it is essential to assess the quality of the clustering because this is performed by a Dirichlet process and it is affected by varying degrees of noise. To do this, we use <code class="docutils literal notranslate"><span class="pre">plot-bins</span></code>, i.e. the HATCHet’s component designed for the analysis of the data, and produce the cluster plot using the <code class="docutils literal notranslate"><span class="pre">CBB</span></code> command. To help we use the following options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--xmin</span> <span class="pre">0.5</span></code> and <code class="docutils literal notranslate"><span class="pre">--xmax</span> <span class="pre">4</span></code> allow to zoom in and to focus the figure on the same RDR (x-axis) range for every sample.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--colwrap</span> <span class="pre">3</span></code> allows to have the 3 plots of the 3 samples on the same figure row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-tS</span> <span class="pre">0.005</span></code> asks to plot only the clusters which cover at least the <code class="docutils literal notranslate"><span class="pre">0.5%</span></code> of the genome. This is useful to clean the figure and focus on the main components.
To trace all steps, we also move the figure to <code class="docutils literal notranslate"><span class="pre">tR015-cbb.pdf</span></code>.</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">PLOTBINS</span><span class="si">}</span><span class="w"> </span>-c<span class="w"> </span>CBB<span class="w"> </span>demo-wgs-cancer.bbc<span class="w"> </span>--ymin<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span>--ymax<span class="w"> </span><span class="m">4</span><span class="w"> </span>--colwrap<span class="w"> </span><span class="m">3</span><span class="w"> </span>-tS<span class="w"> </span><span class="m">0</span>.005
mv<span class="w"> </span>bb_clustered.png<span class="w"> </span>tR015-cbb.png
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We thus obtain the following clustering:</p>
<p><img alt="Bad clustering with default values" src="../../_images/tR015-cbb1.png" /></p>
<p>We can easily notice that the clustering is not ideal and is clearly overfitting the data by choosing too many distinct clusters; in fact we notice the presence of many different clusters that are extremely close and have identical BAF in every sample, e.g. light blue/dark blue/light orange/dark grey clusters or orange/purple clusters or pink/light gray clusters are always adjacent clusters which appear to be part of wider cluster. A good condition to assess the quality of the clustering is to assess that every pair of clusters is clearly distinct in one of the two dimensions (RDR and BAF) in <strong>at least one</strong> sample.</p>
<p>Since Dirichlet clustering is not ad-hoc for this application, it can often result in overclustering. For this reason, cluster-bins additionally provides a procedure to merge clusters which are very likely to be part of a single cluster. However this procedure requires two maximum thresholds for doing this, one is the maximum shift for RDR (<code class="docutils literal notranslate"><span class="pre">-tR</span> <span class="pre">0.15</span></code>) and one is the maximum shift for BAF (<code class="docutils literal notranslate"><span class="pre">-tB</span> <span class="pre">0.03</span></code>). The default values allow to work with most of the datasets, however datasets of high variance require to tune these parameters. In our example, while the BAF of the clusters appears to be consistent with the default threshold, RDR appears to have much higher variance; in fact, the clusters that are always adjacent span much more than 0.15 of RDR in the x-axis. Therefore, by looking at the plot, we can see that a value of <code class="docutils literal notranslate"><span class="pre">-tR</span> <span class="pre">0.5</span></code> fit much better the noise of RDR in our data and we repeat the clustering with this value.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">CLUSTERBINS</span><span class="si">}</span><span class="w"> </span>demo-wgs-cancer.bb<span class="w"> </span>-o<span class="w"> </span>demo-wgs-cancer.seg<span class="w"> </span>-O<span class="w"> </span>demo-wgs-cancer.bbc<span class="w"> </span>-e<span class="w"> </span><span class="m">12</span><span class="w"> </span>-tB<span class="w"> </span><span class="m">0</span>.03<span class="w"> </span>-tR<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span>-d<span class="w"> </span><span class="m">0</span>.08
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We assess again the clustering using <code class="docutils literal notranslate"><span class="pre">plot-bins</span></code> as before.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">PLOTBINS</span><span class="si">}</span><span class="w"> </span>-c<span class="w"> </span>CBB<span class="w"> </span>demo-wgs-cancer.bbc<span class="w"> </span>--ymin<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span>--ymax<span class="w"> </span><span class="m">4</span><span class="w"> </span>--colwrap<span class="w"> </span><span class="m">3</span><span class="w"> </span>-tS<span class="w"> </span><span class="m">0</span>.008
mv<span class="w"> </span>bb_clustered.png<span class="w"> </span>cbb.png
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We thus obtain the following clustering:</p>
<p><img alt="Better clustering with default values" src="../../_images/tR05-cbb.png" /></p>
<p>In this clustering the previously-described condition is met and all the different clusters are clearly distinct in at least one sample.</p>
</section>
<section id="hatchet-s-step">
<h2>hatchet’s step<a class="headerlink" href="#hatchet-s-step" title="Permalink to this heading">¶</a></h2>
<p>In the last step we apply <code class="docutils literal notranslate"><span class="pre">hatchet</span></code>, i.e. the component of HATCHet which estimates fractional copy numbers, infers allele-and-clone specific copy numbers, and jointly predicts the number of clones (including the normal clone) and the presence of a WGD.
We apply the last step with default parameters and, for simplicity of this demo, we apply only few changes:</p>
<ul class="simple">
<li><p>As the dataset has high variance and noise (see clustering), we consider a minimum clone proportion <code class="docutils literal notranslate"><span class="pre">-u</span></code> slightly higher than the default value, i.e. <code class="docutils literal notranslate"><span class="pre">10%</span></code>. We do this because we cannot infer tumor clones with very low proportions when there is high noise and because potential clones inferred with very low proportions may simply be the result of overfitting. In fact, when using values of <code class="docutils literal notranslate"><span class="pre">-u</span></code> smaller than <code class="docutils literal notranslate"><span class="pre">10%</span></code> we obtain solutions with clone proporions identical to the minimum value of <code class="docutils literal notranslate"><span class="pre">-u</span></code>; this is the recommended criterion to determine the need of increasing the value of <code class="docutils literal notranslate"><span class="pre">-u</span></code>.</p></li>
<li><p>We limit the number of clones to 6 for simplicity of this demo and because it is a reasonable value for CNAs when consider only few samples from the same patient.</p></li>
<li><p>We only consider 100 restarts for the coordinate-descent method; these are the number of attempts to find the best solution. This number is sufficient in this small example but we reccommend to use at least 400 restarts in standard runs.</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">INFER</span><span class="si">}</span><span class="w"> </span>-i<span class="w"> </span>demo-wgs-cancer<span class="w"> </span>-n2,6<span class="w"> </span>-p<span class="w"> </span><span class="m">100</span><span class="w"> </span>-v<span class="w"> </span><span class="m">2</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span>-r<span class="w"> </span><span class="m">12</span><span class="w"> </span>-eD<span class="w"> </span><span class="m">6</span><span class="w"> </span>-eT<span class="w"> </span><span class="m">12</span><span class="w"> </span>-l<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>hatchet.log
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We obtain the following summary of results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Scores approximating second derivative for diploid results</span>
<span class="c1">## Diploid with 2 clones - OBJ: 32.903145 - score: -0.320298393968</span>
<span class="c1">## Diploid with 3 clones - OBJ: 12.493377 - score: 0.0653576290862</span>
<span class="c1">## Diploid with 4 clones - OBJ: 7.063226 - score: 0.216430182885</span>
<span class="c1">## Diploid with 5 clones - OBJ: 5.521944 - score: 0.0291809338181</span>
<span class="c1">## Diploid with 6 clones - OBJ: 4.478124 - score: -0.11096874579</span>
<span class="c1">## Scores approximating second derivative for tetraploid results</span>
<span class="c1">## Tetraploid with 2 clones - OBJ: 50.187684 - score: -0.351848788241</span>
<span class="c1">## Tetraploid with 3 clones - OBJ: 17.472903 - score: 0.0803178784888</span>
<span class="c1">## Tetraploid with 4 clones - OBJ: 10.139838 - score: 0.162808688228</span>
<span class="c1">## Tetraploid with 5 clones - OBJ: 7.535183 - score: 0.0254150864857</span>
<span class="c1">## Tetraploid with 6 clones - OBJ: 5.791102 - score: -0.0685416532021</span>
<span class="c1"># The chosen diploid solution has 4 clones with OBJ: 7.063226 and score: 0.216430182885</span>
<span class="c1">## The related-diploid resulting files are copied to ./chosen.diploid.bbc.ucn and ./chosen.diploid.seg.ucn</span>
<span class="c1"># The chosen tetraploid solution has 4 clones with OBJ: 10.139838 and score: 0.162808688228</span>
<span class="c1">## The related-tetraploid resulting files are copied to ./chosen.tetraploid.bbc.ucn and ./chosen.tetraploid.seg.ucn</span>
<span class="c1"># The chosen solution is diploid with 4 clones and is written in ./best.bbc.ucn and ./best.seg.ucn</span>
</pre></div>
</div>
<p>HATCHet predicts the presence of 4 clones in the 3 tumor samples and, especially, predicts that 2 samples (A12-C and A12-D) contains two distinct tumor clones. While HATCHet accurately recovers the major tumor clones distinguished by larger CNAs, HATCHet may miss small or minor CNAs, especially CNAs that are only present in a unique sample or in low proportions. Investigating the presence of unique or low proporions clones is particularly interesting in this patient because the high noise and variance make more difficult distinguishing variations in the clusters between those due to either noise or presence of different clones. To investigate the presence of minor or low-proportions clones, we re-run the <code class="docutils literal notranslate"><span class="pre">hatchet</span></code> step by increasing the sensitivity of HATCHet; we do this by decreasing the value of the limit <code class="docutils literal notranslate"><span class="pre">-l</span></code> from the default of <code class="docutils literal notranslate"><span class="pre">0.5</span></code> to <code class="docutils literal notranslate"><span class="pre">0.2</span></code>. Remember that the value that control the sensivity <code class="docutils literal notranslate"><span class="pre">-l</span></code> must be in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code> and the default value is <code class="docutils literal notranslate"><span class="pre">0.5</span></code>; in particular, lower values incrase the sensitivty of HATCHet by exploring solutions with more clones and the presence of small CNAs, whereas higher values decrease the sensitivity. We thus re-run the <code class="docutils literal notranslate"><span class="pre">hatchet</span></code> step as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">INFER</span><span class="si">}</span><span class="w"> </span>-i<span class="w"> </span>demo-wgs-cancer<span class="w"> </span>-n2,6<span class="w"> </span>-p<span class="w"> </span><span class="m">100</span><span class="w"> </span>-v<span class="w"> </span><span class="m">2</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span>-r<span class="w"> </span><span class="m">12</span><span class="w"> </span>-eD<span class="w"> </span><span class="m">6</span><span class="w"> </span>-eT<span class="w"> </span><span class="m">12</span><span class="w"> </span>-l<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>hatchet.log
:&lt;&lt;<span class="s1">&#39;```shell&#39;</span><span class="w"> </span><span class="c1"># Ignore this line</span>
</pre></div>
</div>
<p>We obtain the following summary of results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Scores approximating second derivative for diploid results</span>
<span class="c1">## Diploid with 2 clones - OBJ: 32.903145 - score: -0.420298393968</span>
<span class="c1">## Diploid with 3 clones - OBJ: 12.493377 - score: -0.234642370914</span>
<span class="c1">## Diploid with 4 clones - OBJ: 7.063226 - score: -0.0182121880285</span>
<span class="c1">## Diploid with 5 clones - OBJ: 5.521944 - score: 0.0109687457895</span>
<span class="c1">## Diploid with 6 clones - OBJ: 4.478124 - score: -0.11096874579</span>
<span class="c1">## Scores approximating second derivative for tetraploid results</span>
<span class="c1">## Tetraploid with 2 clones - OBJ: 50.187684 - score: -0.451848788241</span>
<span class="c1">## Tetraploid with 3 clones - OBJ: 17.472903 - score: -0.219682121511</span>
<span class="c1">## Tetraploid with 4 clones - OBJ: 10.139838 - score: -0.0568734332836</span>
<span class="c1">## Tetraploid with 5 clones - OBJ: 7.535183 - score: -0.0314583467979</span>
<span class="c1">## Tetraploid with 6 clones - OBJ: 5.791102 - score: -0.1</span>
<span class="c1"># The chosen diploid solution has 5 clones with OBJ: 5.521944 and score: 0.0109687457895</span>
<span class="c1">## The related-diploid resulting files are copied to ./chosen.diploid.bbc.ucn and ./chosen.diploid.seg.ucn</span>
<span class="c1"># The chosen tetraploid solution has 5 clones with OBJ: 7.535183 and score: -0.0314583467979</span>
<span class="c1">## The related-tetraploid resulting files are copied to ./chosen.tetraploid.bbc.ucn and ./chosen.tetraploid.seg.ucn</span>
<span class="c1"># The chosen solution is diploid with 5 clones and is written in ./best.bbc.ucn and ./best.seg.ucn</span>
</pre></div>
</div>
<p>HATCHet indeed finds an additional tumor clone which is unique to sample A12-D and has some small and specific CNAs which are only present in this sample. This conclude the inference and the final results containing clone and allele-specific copy numbers are available for every bin in <code class="docutils literal notranslate"><span class="pre">best.bbc.ucn</span></code> and for segments in a compact format in <code class="docutils literal notranslate"><span class="pre">best.seg.ucn</span></code>.</p>
</section>
<section id="analyzing-inferred-results">
<h2>Analyzing inferred results<a class="headerlink" href="#analyzing-inferred-results" title="Permalink to this heading">¶</a></h2>
<p>Finally, we obtain useful plots to summarize and analyze the inferred results by using <code class="docutils literal notranslate"><span class="pre">plot-cn</span></code>, which is the last component of HATCHet. We run <code class="docutils literal notranslate"><span class="pre">plot-cn</span></code> as follows</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">PLOTCN</span><span class="si">}</span><span class="w"> </span>best.bbc.ucn
<span class="nb">exit</span><span class="w"> </span><span class="nv">$?</span>
</pre></div>
</div>
<p>First, <code class="docutils literal notranslate"><span class="pre">plot-cn</span></code> summarizes the values of tumor purity and tumor ploidy for every sample of the patient as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### SAMPLE: A12-D -- PURITY: 0.820847 -- PLOIDY: 2.13676481963 -- CLASSIFICATION: DIPLOID</span>
<span class="c1">### SAMPLE: A12-C -- PURITY: 0.771882 -- PLOIDY: 2.07266027371 -- CLASSIFICATION: DIPLOID</span>
<span class="c1">### SAMPLE: A12-A -- PURITY: 0.779084 -- PLOIDY: 2.09771617784 -- CLASSIFICATION: DIPLOID</span>
</pre></div>
</div>
<p>Next, <code class="docutils literal notranslate"><span class="pre">plot-cn</span></code> produces some informative plots to evaluate the inferred results. Among all the plots, 3 of those are particularly important.</p>
<p>The first <code class="docutils literal notranslate"><span class="pre">intratumor-clones-totalcn.pdf</span></code> represents the total-copy numbers for all tumor clones in fixed-size regions (obtained by merging neighboring genomic bins).
<img alt="intratumor-clones-totalcn.pdf" src="../../_images/totalcn2.png" />
Every tumor clone is identified by a color and a dot is drawn for every genomic region (which are partitioned) for the corresponding total copy number.</p>
<p>The second <code class="docutils literal notranslate"><span class="pre">intratumor-clones-allelecn.pdf</span></code> similarly represents the allele-specific copy numbers (split between the bottom and top regions of the figure) as the plot above.
<img alt="intratumor-clones-allelecn.pdf" src="../../_images/allelecn2.png" /></p>
<p>The third <code class="docutils literal notranslate"><span class="pre">intratumor-profiles.pdf</span></code> represents both the clone proportions and the total copy numbers of every clone in genomic regions.
<img alt="intratumor-clones-allelecn.pdf" src="../../_images/profiles2.png" />
The main heatmap in the right side of the figure represent the total copy number of every clone (i.e. a row) for every genomic region (which are partition into chromosomes as described at the top of the heatmap) such that grey color indicate regions with base copy number not affected by CNAs (but they can be affected by a WGD when this occurrs), blue colors indicates deletions, and red colors indicate amplifications; in general, the stronger the color the smaller/higher the corresponding aberration. The smaller heatmap in the left side describes the clone proportion of each clone in each sample such that the lightest color correspond to absence while darker colors indicate higher clone proportions. Last, in the left-most part there is a dendogram which hierarchically clusters the tumor clones based on similiraity.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Princeton University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>